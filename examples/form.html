
<style>
  body {
    padding: 50px;
    font: 14px Helvetica, Arial;
  }
  form {
    display: inline-block;
    border: 1px solid #eee;
    padding: 15px 20px;
  }
</style>

<script src="../build/build.js"></script>

<div id="pet">
  <h2 data-text="name"></h2>
  <p><span data-text="name">name</span> is a <span data-text="age">age</span> year old <span data-text="species"></span>, he has <span data-text="friendCount"></span> friends.</p>
</div>

<form id="edit-pet">
  <legend>Edit</legend>
  <p>
    <input type="text" name="name" data-value="name" placeholder="Name" on-input="updateName" />
  </p>
  <p>
    <input type="text" name="age" data-value="age" placeholder="Age" on-change="updateAge" />
  </p>
  <p>
    <input type="range" min="0" max="10" value="2" name="friends" on-change="updateFriends" />
  </p>
</form>

<script>
  var Emitter = require('component-emitter');
  var reactive = require('reactive');
  var tmpl = document.querySelector('#pet');

  var pet = {
    name: 'Tobi',
    species: 'ferret',
    age: 2,
    friends: ['luna', 'manny', 'abby']
  };

  Emitter(pet);

  function PetView(pet) {
    this.pet = pet;
    reactive(tmpl, pet, this);
  }
  
  PetView.prototype.friendCount = function(){
    var n = this.pet.friends.length;
    return 0 == n ? 'no' : n;
  };
  
  var view = new PetView(pet);

  reactive(document.querySelector('#edit-pet'), pet, {
    updateFriends: function(e){
      var n = parseInt(e.target.value, 10);
      pet.friends = Array(n);
      pet.emit('change', 'friendCount');
    },
    
    updateName: function(e){
      pet.name = e.target.value;
      pet.emit('change', 'name', e.target.value);
    },
    
    updateAge: function(e){
      pet.age = parseInt(e.target.value, 10);
      pet.emit('change', 'age', pet.age);;
    }
  });
</script>